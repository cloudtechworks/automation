#Following script has been made regarding CVE-2022-42889
#This can also be modified to contain more vurnarability hashes, see the hash list below

$List = [System.Collections.ArrayList]::new()
$TotalResults = [System.Collections.ArrayList]::new()
$Drives = (Get-PSDrive -PSProvider FileSystem | Where-Object { $_.Used -gt 0 }).Root

If(!(Test-Path "$env:SystemDrive\TextsShelltemp")){

    New-Item -ItemType Directory "$env:SystemDrive\TextsShelltemp" -Force | Out-Null

}
 
ForEach($Drive in $Drives) {
 
    Robocopy $Drive C:\TextsShelltemp *.jar /s /b /l /fp /xj /ndl /njh /njs /nc /ns | ForEach-Object { $List.Add("$_")} | Out-Null
 
}

$hashlist = @("46BF0F4460C0CDEA92193B61C21D7CABEDCB29415A67EB21663EEE3E1CBC3F94",
"EACC737213AFBF838B33B04213771E7A5A08CD1CC3C65774569C797E50EF4225",
"F85E8A555B740C533D769EDA50C2BEFA3FAEF3B0D89613149E1CE27C64DD8843",
"50E2B1DE2A62EBF524A59DECC1035C7A9A89D07EFD1C6E6627A1252996B0250B",
"33D8E93C96693BF9AAC5F42A9B62B63C58F658EFA7C9D1CC4993F9F15D466E97",
"C08952A8ABE19A68F3E2B92A40630EA35BA940AF2718A0857F997592DD0370C8",
"B953533503802A55CE4640DC4171B596462E0B24DD81CDA204BFF469369A27A8",
"C57D71888EACA98E4A2A6821842AEBA6C3473B0EC58AE476E1710E7E218786BD",
"7049216ECD4B9078440B477F17387FAE4A790C866D421243648045763CA77744",
"F92BC312D77A4A180F940D08253775F4BE19877DCFDA859CE98468E0B8475A96",
"92D7B82ED39A3234D7A79C2F08E036E473F07C60FA348BFBF7FD9CD3B5709BB5",
"3F24065F7D4B847951E9E098CBB2AD39F245D4761A6AB2EA67CE600E58DC1F90",
"6EF1CA0CA0E4D96AEC28A2125F79217A46CF5889608EAF1B8B209B5E6C0FDFFF",
"AFC51FE4DCACB67A07C948F4D890D3F86069A5AADA6723F0DFC1FF87BC1A3808",
"0149A81B421E646646D8724E0500F71264893C790AA2A771C056A1E984F02434",
"09252FB636C71001F80721CE2A7A7F1CAC1EC272C43F501C303FF9E8C6874F2C",
"E767596163DA9B22E8FC83FF954E41E19E96744DF7625B06F8DAAC3C4D60F79D",
"F898985AD93955366D372FB15D51213340FFD8FBC6CDB4289E448D92B612CF32",
"613585EE9B45A3AF2958221A1431C1D279EEEAC7DD6F6126CABBA84BFF0ECAFA",
"770CD903FA7B604D1F7EF7BA17F84108667294B2B478BE8ED1AF3BFFB4AE0018",
"4C450D8F58D1F64211E36149F9D32C95A76544DF2D38ADB0E375C66D1F43BFD3",
"0F2AA2FF65073CD7A1ED5ADB124A9BEC40589DC00B74B29D09EE06A3DB791574",
"82A506CE90F36C17F9B1BC85556EDC8B5D11A1807CED1CF55A118DC4F5F8A58A",
"7798F024C59024D4CCCDBC739589B3BAE34A4EAA556DFEC1B6E4498C72962E73",
"D4A57BBC1627DA7C391308FD0FE910B83170FB66AFD117236A5B111D2DB1590B",
"1453013CE7920D1C99F8C31AF8693B183E4B7F8CD43C97B215A47A6D2418BBC8",
"E33C5C4DCB6169513F623AE9B0E40FA5A2790919E2F8871CE4BC5CF027651AE8",
"0CC4F216DA8EC9FD30A65E10A70A14ED81A7DC2FF9EDBE8430D7D75CF4D347E3",
"0887A1C6FA59D3C9825CF49766FE2C64383C24CB90FE009707D5203979339BFF",
"8185B3A5311092D83ED1F184C2D093B3105D726BBD76867C32B3511542BB99A8",
"765D8236908E1AA7EE9DBBF165FDD993709FFB7D23991CA6BE5F8A750B77A381",
"00D006377BBE1667B8FDAA5BB3DA35137C0D3BC28E7426276FCB1F5A50630EB2",
"CFAEDE7310CB5F669C1C9AD2C0453F65A7F0DC704A4531F634944ECDDC03C667",
"078049288745A90D113B2A055471FEC30D0C971C79571A9FF1414C9AEB1D70E1",
"D624E443240A5FCCC93EDBFE758DF1B69C07D7EAAB6FC5E8F98F77D86CED8259",
"C7EB048768A67FAA37CECCD4F049CF4D618C57941A6F46435E9928019FEAA8A7",
"00C37E139210B2BF41A2BD32FDF58C3A74C85303A7DBFC54DB5983A48D43BC44",
"C905AFF4CB65EA6B5BA15B9066B0B0760BFE12F7420FD5909970CEE7369FC813",
"34AECF32CA739BC8A74E80EA4185CBB83B61793443CCB7B1C3E23486DC1853E1",
"E0642E88241D083ED184848A6A8B39670A48E484963C483A8ACB266F09874B77",
"2B5BB81936C95D53EE7AA5E3893C85271F0282472C1BA0E1E70C7AF3EB653451",
"F1D31E721B929372DA72616E7F493F1916A3268624A0A596A0C1F7ABD2C7CAF0",
"F5EA53C10DB97E413CF27208FAC60563B74E2CDEB6A1653FF27EFA08776D20D9",
"18C478C8D9AF2FA8937A402B53ED239887837A682E6E915D6E837C190752B28A",
"DF45E56549B63E0FE716953C9D43CC158F8BF008BAF60498E7C17F3FAA00A70B",
"C900BBBB8F84A385B2AEDD3913DD5C796F4C82999D7F34558DB70ED5514DF229",
"D7B1DE3DE0ADEA7835DECB05975A062FA4CB47542DBCF79747428917AA14DE4F",
"E34CAC1EBBA1144FC5CF5B09FA545FB5ED8329443F39D80BF3E60EF16B566985",
"CCFD1CC839CA21DFC606EE6677E88445F95388436BE9F4FD1D8271CA8357628B",
"8434BBFB887E7A0F3DFEF92AC84E783F847BC0F0F43B8CC9E026646B137B6065",
"8E282D0A9DB98EC5473398BFBD8E6657402ABAD9F35C48B8B24C994DBD2827F6",
"5AE0583A8A56FBDED1C94D527AE20C9DBC03E7A0D72BC9310099739647CD2CDD",
"E1D784262BEC22C04647592EA99E4DEC1646BBD6852160061AF5ECE92FEA28F6",
"5BE100094486B48A8E042D0EC14A69637BFB7138C0383464CC9D1564D4692B7C",
"6FE7AD4AD5349D6B77E7A0E1C9F6037108A1EE48C42E7E6EB4B18F56D324F7B2",
"BFD53C96D23CEFA32E7023117582126A4B7D27191FDCD2B937317F54F8644E73",
"86E6FAE70B9BF61D6DCCD8BFECDFA8C893B44CAC78AFAC9CA9C584E9169DE44D",
"53848F96170E7A2CF1F6851C09FA4961A9317D7D03692033A9B9BEFC9D7E1A2D",
"F4E3EBB689EB35A9890DEC9F69FFA121997ADFF8C838FA96CF6FDCE2600CD2C1",
"0812F284AC5DD0D617461D9A2AB6AC6811137F25122DFFFD4788A4871E732D00"
)
 
$TotalResults = ForEach($Item in $List) {
 
    If($Item.Length -gt 0) {
 
        $Hash = (Get-FileHash -Path "\\?\$Item" -Algorithm SHA256 -erroraction 'silentlycontinue').Hash
		if ($Hash -in $hashlist){
					$Result = [PSCustomObject]@{
						"Hostname" = $env:ComputerName
						"File Hash" = $Hash
						"File Name" = $Item
					}
					$Result	
        }
 
}
}
$TotalResults
